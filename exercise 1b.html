<!DOCTYPE html>
<html>
<head>
    <title>Microblog App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 700px;
            margin: 50px auto;
            padding: 10px;
        }
        h1, h2 {
            text-align: center;
        }
        select, textarea, button, input {
            width: 100%;
            margin: 5px 0;
            padding: 5px;
        }
        .post {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            background: #f9f9f9;
        }
    </style>
</head>
<body>

<h1>Simple Microblog App</h1>

<input type="text" id="newUser" placeholder="Add new user name">
<button onclick="addUser()">Add User</button>


<label for="currentUser">Select User:</label>
<select id="currentUser"></select>

<h2>Follow Users</h2>
<select id="followSelect" multiple></select>
<button onclick="updateFollowing()">Follow Selected Users</button>

<h2>Create Post</h2>
<textarea id="postContent" placeholder="Write something..."></textarea>
<button onclick="addPost()">Post</button>

<h2>Feed</h2>
<div id="feedContainer"></div>

<script>
    let users = [];
    let posts = [];
    let following = {}; 

    function addUser() {
        const name = document.getElementById("newUser").value.trim();
        if(name === "") { alert("User name cannot be empty!"); return; }
        if(users.includes(name)) { alert("User already exists!"); return; }

        users.push(name);
        following[name] = []; 
        document.getElementById("newUser").value = "";
        updateUserSelect();
    }

    function updateUserSelect() {
        const userSelect = document.getElementById("currentUser");
        userSelect.innerHTML = "";
        users.forEach(u => {
            const option = document.createElement("option");
            option.value = u;
            option.text = u;
            userSelect.appendChild(option);
        });
        updateFollowSelect();
        showFeed();
    }

    function updateFollowSelect() {
        const followSelect = document.getElementById("followSelect");
        followSelect.innerHTML = "";
        const currentUser = document.getElementById("currentUser").value;
        users.forEach(u => {
            if(u !== currentUser) {
                const option = document.createElement("option");
                option.value = u;
                option.text = u;
                if(following[currentUser].includes(u)) option.selected = true;
                followSelect.appendChild(option);
            }
        });
    }

    document.getElementById("currentUser").addEventListener("change", () => {
        updateFollowSelect();
        showFeed();
    });

    function updateFollowing() {
        const currentUser = document.getElementById("currentUser").value;
        const followSelect = document.getElementById("followSelect");
        following[currentUser] = Array.from(followSelect.selectedOptions).map(o => o.value);
        showFeed();
    }

    function addPost() {
        const user = document.getElementById("currentUser").value;
        const content = document.getElementById("postContent").value.trim();
        if(content === "") { alert("Post cannot be empty!"); return; }

        posts.push({user: user, content: content});
        document.getElementById("postContent").value = "";
        showFeed();
    }

    function showFeed() {
        const currentUser = document.getElementById("currentUser").value;
        const container = document.getElementById("feedContainer");
        container.innerHTML = "";

       
        const visiblePosts = posts.filter(post => following[currentUser].includes(post.user));

        if(visiblePosts.length === 0){
            container.innerHTML = "<p>No posts from users you follow yet.</p>";
            return;
        }

        visiblePosts.reverse().forEach(post => {
            const postDiv = document.createElement("div");
            postDiv.className = "post";
            postDiv.innerHTML = `<strong>${post.user}</strong>: ${post.content}`;
            container.appendChild(postDiv);
        });
    }
</script>

</body>
</html>
